import{a as B,u as z}from"./vendor-5WKb-KWd2YoVw.js";import{u as Q}from"./vendor-hmuK-B6xHqdWm.js";import{r as o,u as F}from"./vendor-eqDO-Ti6p_k8X.js";import{m as S,w as _,c as h,e as Z,t as ee}from"./vendor-RE7Z-DOm9JKld.js";function oe(i,n,a,l){const N=o(!1),V=o(null),L=o(!1),Y=e=>{L.value=e},d=o({width:null,height:null,headerHeight:null}),A=o(!1),K={display:"inline-block",verticalAlign:"middle"},x=o(),R=o(0),w=o(0),g=o(0),v=o(0),b=o(0);S(()=>{n.setHeight(i.height)}),S(()=>{n.setMaxHeight(i.maxHeight)}),_(()=>[i.currentRowKey,a.states.rowKey],([e,t])=>{!F(t)||!F(e)||a.setCurrentRowKey(`${e}`)},{immediate:!0}),_(()=>i.data,e=>{l.store.commit("setData",e)},{immediate:!0,deep:!0}),S(()=>{i.expandRowKeys&&a.setExpandRowKeysAdapter(i.expandRowKeys)});const X=()=>{l.store.commit("setHoverRow",null),l.hoverState&&(l.hoverState=null)},D=(e,t)=>{const{pixelX:r,pixelY:s}=t;Math.abs(r)>=Math.abs(s)&&(l.refs.bodyWrapper.scrollLeft+=t.pixelX/5)},C=h(()=>i.height||i.maxHeight||a.states.fixedColumns.value.length>0||a.states.rightFixedColumns.value.length>0),T=h(()=>({width:n.bodyWidth.value?`${n.bodyWidth.value}px`:""})),p=()=>{C.value&&n.updateElsHeight(),n.updateColumnsWidth(),!(typeof window>"u")&&requestAnimationFrame(M)};Z(async()=>{await ee(),a.updateColumns(),q(),requestAnimationFrame(p);const e=l.vnode.el,t=l.refs.headerWrapper;i.flexible&&e&&e.parentElement&&(e.parentElement.style.minWidth="0"),d.value={width:x.value=e.offsetWidth,height:e.offsetHeight,headerHeight:i.showHeader&&t?t.offsetHeight:null},a.states.columns.value.forEach(r=>{r.filteredValue&&r.filteredValue.length&&l.store.commit("filterChange",{column:r,values:r.filteredValue,silent:!0})}),l.$ready=!0});const k=(e,t)=>{if(!e)return;const r=Array.from(e.classList).filter(s=>!s.startsWith("is-scrolling-"));r.push(n.scrollX.value?t:"is-scrolling-none"),e.className=r.join(" ")},m=e=>{const{tableWrapper:t}=l.refs;k(t,e)},P=e=>{const{tableWrapper:t}=l.refs;return!!(t&&t.classList.contains(e))},M=function(){if(!l.refs.scrollBarRef)return;if(!n.scrollX.value){const H="is-scrolling-none";P(H)||m(H);return}const e=l.refs.scrollBarRef.wrapRef;if(!e)return;const{scrollLeft:t,offsetWidth:r,scrollWidth:s}=e,{headerWrapper:u,footerWrapper:f}=l.refs;u&&(u.scrollLeft=t),f&&(f.scrollLeft=t);const W=s-r-1;t>=W?m("is-scrolling-right"):m(t===0?"is-scrolling-left":"is-scrolling-middle")},q=()=>{l.refs.scrollBarRef&&(l.refs.scrollBarRef.wrapRef&&B(l.refs.scrollBarRef.wrapRef,"scroll",M,{passive:!0}),i.fit?z(l.vnode.el,y):B(window,"resize",y),z(l.refs.bodyWrapper,()=>{var e,t;y(),(t=(e=l.refs)==null?void 0:e.scrollBarRef)==null||t.update()}))},y=()=>{var e,t,r,s;const u=l.vnode.el;if(!l.$ready||!u)return;let f=!1;const{width:W,height:H,headerHeight:J}=d.value,$=x.value=u.offsetWidth;W!==$&&(f=!0);const E=u.offsetHeight;(i.height||C.value)&&H!==E&&(f=!0);const c=i.tableLayout==="fixed"?l.refs.headerWrapper:(e=l.refs.tableHeaderRef)==null?void 0:e.$el;i.showHeader&&(c==null?void 0:c.offsetHeight)!==J&&(f=!0),R.value=((t=l.refs.tableWrapper)==null?void 0:t.scrollHeight)||0,g.value=(c==null?void 0:c.scrollHeight)||0,v.value=((r=l.refs.footerWrapper)==null?void 0:r.offsetHeight)||0,b.value=((s=l.refs.appendWrapper)==null?void 0:s.offsetHeight)||0,w.value=R.value-g.value-v.value-b.value,f&&(d.value={width:$,height:E,headerHeight:i.showHeader&&(c==null?void 0:c.offsetHeight)||0},p())},U=Q(),j=h(()=>{const{bodyWidth:e,scrollY:t,gutterWidth:r}=n;return e.value?`${e.value-(t.value?r:0)}px`:""}),G=h(()=>i.maxHeight?"fixed":i.tableLayout),O=h(()=>{if(i.data&&i.data.length)return null;let e="100%";i.height&&w.value&&(e=`${w.value}px`);const t=x.value;return{width:t?`${t}px`:"",height:e}}),I=h(()=>i.height?{height:"100%"}:i.maxHeight?Number.isNaN(Number(i.maxHeight))?{maxHeight:`calc(${i.maxHeight} - ${g.value+v.value}px)`}:{maxHeight:`${i.maxHeight-g.value-v.value}px`}:{});return{isHidden:N,renderExpanded:V,setDragVisible:Y,isGroup:A,handleMouseLeave:X,handleHeaderFooterMousewheel:D,tableSize:U,emptyBlockStyle:O,handleFixedMousewheel:(e,t)=>{const r=l.refs.bodyWrapper;if(Math.abs(t.spinY)>0){const s=r.scrollTop;t.pixelY<0&&s!==0&&e.preventDefault(),t.pixelY>0&&r.scrollHeight-r.clientHeight>s&&e.preventDefault(),r.scrollTop+=Math.ceil(t.pixelY/5)}else r.scrollLeft+=Math.ceil(t.pixelX/5)},resizeProxyVisible:L,bodyWidth:j,resizeState:d,doLayout:p,tableBodyStyles:T,tableLayout:G,scrollbarViewStyle:K,scrollbarStyle:I}}export{oe as u};
