import{g as $,l as Ae,n as Ke,a as K,t as G,o as ke}from"./vendor-8jHm-DXstvPfe.js";import{u as De}from"./vendor-3v3y-BDPMyocZ.js";import{u as Ie}from"./vendor-owUc-B7cdTicf.js";import{u as Me}from"./vendor-GpGL-CnVUMjIy.js";import{i as J,h as Pe,c as X}from"./vendor-7avT-DhdrFwTb.js";import{t as Te,r as o,u as Be}from"./vendor-eqDO-Ti6p_k8X.js";import{g as je,c as Ne,w as Ue}from"./vendor-RE7Z-DOm9JKld.js";const ze=(p,n)=>{const v=n.sortingColumn;return!v||X(v.sortable)?p:ke(p,n.sortProp,n.sortOrder,v.sortMethod,v.sortBy)},F=p=>{const n=[];return p.forEach(v=>{v.children&&v.children.length>0?n.push.apply(n,F(v.children)):n.push(v)}),n};function Ye(){var p;const n=je(),{size:v}=Te((p=n.proxy)==null?void 0:p.$props),f=o(null),d=o([]),k=o([]),D=o(!1),g=o([]),I=o([]),y=o([]),m=o([]),E=o([]),Y=o([]),Z=o([]),ee=o([]),te=[],M=o(0),P=o(0),T=o(0),x=o(!1),c=o([]),le=o(!1),B=o(!1),S=o(null),R=o({}),L=o(null),C=o(null),O=o(null),A=o(null),ne=o(null),w=Ne(()=>f.value?$(c.value,f.value):void 0);Ue(d,()=>{var e;n.state&&(U(!1),n.props.tableLayout==="auto"&&((e=n.refs.tableHeaderRef)==null||e.updateFixedColumnStyle()))},{deep:!0});const ae=()=>{if(!f.value)throw new Error("[ElTable] prop row-key is required")},j=e=>{var t;(t=e.children)==null||t.forEach(l=>{l.fixed=e.fixed,j(l)})},N=()=>{var e,t;g.value.forEach(s=>{j(s)}),m.value=g.value.filter(s=>s.type!=="selection"&&[!0,"left"].includes(s.fixed));let l;if(((t=(e=g.value)==null?void 0:e[0])==null?void 0:t.type)==="selection"){const s=g.value[0];l=[!0,"left"].includes(s.fixed)||m.value.length&&s.fixed!=="right",l&&m.value.unshift(s)}E.value=g.value.filter(s=>s.fixed==="right");const a=g.value.filter(s=>(l?s.type!=="selection":!0)&&!s.fixed);I.value=[].concat(m.value).concat(a).concat(E.value);const u=F(a),r=F(m.value),i=F(E.value);M.value=u.length,P.value=r.length,T.value=i.length,y.value=[].concat(r).concat(u).concat(i),D.value=m.value.length>0||E.value.length>0},U=(e,t=!1)=>{e&&N(),t?n.state.doLayout():n.state.debouncedUpdateLayout()},z=e=>w.value?!!w.value[K(e,f.value)]:c.value.includes(e),oe=()=>{x.value=!1;const e=c.value;c.value=[],e.length&&n.emit("selection-change",[])},se=()=>{let e;if(f.value){e=[];const t=$(d.value,f.value);for(const l in w.value)Pe(w.value,l)&&!t[l]&&e.push(w.value[l].row)}else e=c.value.filter(t=>!d.value.includes(t));if(e.length){const t=c.value.filter(l=>!e.includes(l));c.value=t,n.emit("selection-change",t.slice())}},ue=()=>(c.value||[]).slice(),re=(e,t,l=!0,a=!1)=>{var u,r,i,s;const h={children:(r=(u=n==null?void 0:n.store)==null?void 0:u.states)==null?void 0:r.childrenColumnName.value,checkStrictly:(s=(i=n==null?void 0:n.store)==null?void 0:i.states)==null?void 0:s.checkStrictly.value};if(G(c.value,e,t,h,a?void 0:S.value,d.value.indexOf(e))){const b=(c.value||[]).slice();l&&n.emit("select",b,e),n.emit("selection-change",b)}},ce=()=>{var e,t;const l=B.value?!x.value:!(x.value||c.value.length);x.value=l;let a=!1,u=0;const r=(t=(e=n==null?void 0:n.store)==null?void 0:e.states)==null?void 0:t.rowKey.value,{childrenColumnName:i}=n.store.states,s={children:i.value,checkStrictly:!1};d.value.forEach((h,_)=>{const b=_+u;G(c.value,h,l,s,S.value,b)&&(a=!0),u+=H(K(h,r))}),a&&n.emit("selection-change",c.value?c.value.slice():[]),n.emit("select-all",(c.value||[]).slice())},ie=()=>{d.value.forEach(e=>{const t=K(e,f.value),l=w.value[t];l&&(c.value[l.index]=e)})},de=()=>{var e;if(((e=d.value)==null?void 0:e.length)===0){x.value=!1;return}const{childrenColumnName:t}=n.store.states;let l=0,a=0;const u=i=>{var s;for(const h of i){const _=S.value&&S.value.call(null,h,l);if(z(h))a++;else if(!S.value||_)return!1;if(l++,(s=h[t.value])!=null&&s.length&&!u(h[t.value]))return!1}return!0},r=u(d.value||[]);x.value=a===0?!1:r},H=e=>{var t;if(!n||!n.store)return 0;const{treeData:l}=n.store.states;let a=0;const u=(t=l.value[e])==null?void 0:t.children;return u&&(a+=u.length,u.forEach(r=>{a+=H(r)})),a},ve=(e,t)=>{J(e)||(e=[e]);const l={};return e.forEach(a=>{R.value[a.id]=t,l[a.columnKey||a.id]=t}),l},V=(e,t,l)=>{C.value&&C.value!==e&&(C.value.order=null),C.value=e,O.value=t,A.value=l},q=()=>{let e=Be(k);Object.keys(R.value).forEach(t=>{const l=R.value[t];if(!l||l.length===0)return;const a=Ke({columns:y.value},t);a&&a.filterMethod&&(e=e.filter(u=>l.some(r=>a.filterMethod.call(null,r,u,a))))}),L.value=e},Q=()=>{d.value=ze(L.value,{sortingColumn:C.value,sortProp:O.value,sortOrder:A.value})},fe=(e=void 0)=>{e&&e.filter||q(),Q()},he=e=>{const{tableHeaderRef:t}=n.refs;if(!t)return;const l=Object.assign({},t.filterPanels),a=Object.keys(l);if(a.length)if(X(e)&&(e=[e]),J(e)){const u=e.map(r=>Ae({columns:y.value},r));a.forEach(r=>{const i=u.find(s=>s.id===r);i&&(i.filteredValue=[])}),n.store.commit("filterChange",{column:u,values:[],silent:!0,multi:!0})}else a.forEach(u=>{const r=y.value.find(i=>i.id===u);r&&(r.filteredValue=[])}),R.value={},n.store.commit("filterChange",{column:{},values:[],silent:!0})},pe=()=>{C.value&&(V(null,null,null),n.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:ge,toggleRowExpansion:W,updateExpandRows:me,states:xe,isRowExpanded:Ce}=De({data:d,rowKey:f}),{updateTreeExpandKeys:ye,toggleTreeExpansion:Se,updateTreeData:we,updateKeyChildren:Ee,loadOrToggle:Re,states:_e}=Me({data:d,rowKey:f}),{updateCurrentRowData:be,updateCurrentRow:Fe,setCurrentRowKey:Le,states:Oe}=Ie({data:d,rowKey:f});return{assertRowKey:ae,updateColumns:N,scheduleLayout:U,isSelected:z,clearSelection:oe,cleanSelection:se,getSelectionRows:ue,toggleRowSelection:re,_toggleAllSelection:ce,toggleAllSelection:null,updateSelectionByRowKey:ie,updateAllSelected:de,updateFilters:ve,updateCurrentRow:Fe,updateSort:V,execFilter:q,execSort:Q,execQuery:fe,clearFilter:he,clearSort:pe,toggleRowExpansion:W,setExpandRowKeysAdapter:e=>{ge(e),ye(e)},setCurrentRowKey:Le,toggleRowExpansionAdapter:(e,t)=>{y.value.some(({type:a})=>a==="expand")?W(e,t):Se(e,t)},isRowExpanded:Ce,updateExpandRows:me,updateCurrentRowData:be,loadOrToggle:Re,updateTreeData:we,updateKeyChildren:Ee,states:{tableSize:v,rowKey:f,data:d,_data:k,isComplex:D,_columns:g,originColumns:I,columns:y,fixedColumns:m,rightFixedColumns:E,leafColumns:Y,fixedLeafColumns:Z,rightFixedLeafColumns:ee,updateOrderFns:te,leafColumnsLength:M,fixedLeafColumnsLength:P,rightFixedLeafColumnsLength:T,isAllSelected:x,selection:c,reserveSelection:le,selectOnIndeterminate:B,selectable:S,filters:R,filteredData:L,sortingColumn:C,sortProp:O,sortOrder:A,hoverRow:ne,...xe,..._e,...Oe}}}export{Ye as u};
