import{w as _,a as w}from"./vendor-8F4M-BzORa8vA.js";import{U as z}from"./vendor-SuVG-CfrBdH9q.js";import{u as H}from"./vendor-ROP7-75d5R9Ei.js";import{g as I}from"./vendor-d824-CdLXEnkb.js";import{_ as T}from"./vendor-pM4a-CqGSI99y.js";import{e as V}from"./vendor-X8P5-CF3LkWx9.js";import{u as X}from"./vendor-unoq-CFxLHdLI.js";import{a as G}from"./vendor-hmuK-B6xHqdWm.js";import{n as E,f as R,d as J}from"./vendor-7avT-DhdrFwTb.js";import{c as q}from"./vendor-wm62-DP3OYY5P.js";import{i as Q}from"./vendor-ys5x-C1IsWqtu.js";import{d as K,a as W,o as P,f as Y,r as S,b as Z,h as x}from"./vendor-RE7Z-DOm9JKld.js";import{s as B,u as n}from"./vendor-eqDO-Ti6p_k8X.js";const F=K({name:"ElUploadContent",inheritAttrs:!1}),ee=K({...F,props:H,setup(D,{expose:O}){const s=D,l=X("upload"),c=G(),d=B({}),p=B(),y=e=>{if(e.length===0)return;const{autoUpload:t,limit:o,fileList:a,multiple:r,onStart:u,onExceed:m}=s;if(o&&a.length+e.length>o){m(e,a);return}r||(e=e.slice(0,1));for(const h of e){const f=h;f.uid=I(),u(f),t&&C(f)}},C=async e=>{if(p.value.value="",!s.beforeUpload)return k(e);let t,o={};try{const r=s.data,u=s.beforeUpload(e);o=R(s.data)?q(s.data):s.data,t=await u,R(s.data)&&Q(r,o)&&(o=q(s.data))}catch{t=!1}if(t===!1){s.onRemove(e);return}let a=e;t instanceof Blob&&(t instanceof File?a=t:a=new File([t],e.name,{type:e.type})),k(Object.assign(a,{uid:e.uid}),o)},j=async(e,t)=>J(e)?e(t):e,k=async(e,t)=>{const{headers:o,data:a,method:r,withCredentials:u,name:m,action:h,onProgress:f,onSuccess:M,onError:N,httpRequest:$}=s;try{t=await j(t??a,e)}catch{s.onRemove(e);return}const{uid:b}=e,g={headers:o||{},withCredentials:u,file:e,data:t,method:r,filename:m,action:h,onProgress:i=>{f(i,e)},onSuccess:i=>{M(i,e),delete d.value[b]},onError:i=>{N(i,e),delete d.value[b]}},v=$(g);d.value[b]=v,v instanceof Promise&&v.then(g.onSuccess,g.onError)},A=e=>{const t=e.target.files;t&&y(Array.from(t))},U=()=>{c.value||(p.value.value="",p.value.click())},L=()=>{U()};return O({abort:e=>{V(d.value).filter(e?([o])=>String(e.uid)===o:()=>!0).forEach(([o,a])=>{a instanceof XMLHttpRequest&&a.abort(),delete d.value[o]})},upload:C}),(e,t)=>(P(),W("div",{class:E([n(l).b(),n(l).m(e.listType),n(l).is("drag",e.drag),n(l).is("disabled",n(c))]),tabindex:n(c)?"-1":"0",onClick:U,onKeydown:w(_(L,["self"]),["enter","space"])},[e.drag?(P(),Y(z,{key:0,disabled:n(c),onFile:y},{default:x(()=>[S(e.$slots,"default")]),_:3},8,["disabled"])):S(e.$slots,"default",{key:1}),Z("input",{ref_key:"inputRef",ref:p,class:E(n(l).e("input")),name:e.name,disabled:n(c),multiple:e.multiple,accept:e.accept,type:"file",onChange:A,onClick:_(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var he=T(ee,[["__file","upload-content.vue"]]);export{he as U};
