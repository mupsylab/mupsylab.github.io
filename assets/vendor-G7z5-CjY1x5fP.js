import{w as S}from"./vendor-8F4M-BzORa8vA.js";import{o as Je,c as Ye}from"./vendor-5WKb-KWd2YoVw.js";import{E as Ge}from"./vendor-pkf1-gHYU-KiM.js";import{E as K}from"./vendor-AQSj-DFJim-ok.js";import{E as Qe}from"./vendor-NFpn-BrHihosC.js";import{x as Xe,y as Ze}from"./vendor-Fq1d-qefZ2EtI.js";import{v as de,p as ve,d as A,f as fe}from"./vendor-CCI2-D_GY1FD7.js";import{t as xe}from"./vendor-18Lv-BBtln7yD.js";import{P as ea}from"./vendor-NrAR-CQ0MWBUl.js";import{_ as aa}from"./vendor-pM4a-CqGSI99y.js";import{a as la}from"./vendor-wml0-D8cMrmnG.js";import{u as oa}from"./vendor-cebD-BGFhTQCu.js";import{u as G}from"./vendor-unoq-CFxLHdLI.js";import{u as na}from"./vendor-eqCW-DCj8_tuZ.js";import{u as ta}from"./vendor-GuIu-Dc0c8fP9.js";import{d as me}from"./vendor-0rdd-Cq9Fpw4b.js";import{i as w,a as he,n as b,N as ge,t as sa}from"./vendor-7avT-DhdrFwTb.js";import{u as ra}from"./vendor-hmuK-B6xHqdWm.js";import{E as D}from"./vendor-bP7i-BUADUvnR.js";import{i as ua}from"./vendor-ys5x-C1IsWqtu.js";import{d as be,R as ia,l as ca,c as u,w as pa,t as Q,j as da,f as c,o as p,h as d,r as ye,C as z,i as U,b as va,H as fa,p as ma}from"./vendor-RE7Z-DOm9JKld.js";import{r as g,u as l}from"./vendor-eqDO-Ti6p_k8X.js";const ha=be({name:"Picker"}),ga=be({...ha,props:xe,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(ke,{expose:Pe,emit:m}){const o=ke,Ie=ia(),{lang:C}=oa(),h=G("date"),V=G("input"),k=G("range"),{form:X,formItem:R}=na(),we=ca("ElPopperOptions",{}),{valueOnClear:T}=la(o,null),j=g(),v=g(),s=g(!1),L=g(!1),Z=g(null);let q=!1;const{isFocused:x,handleFocus:ee,handleBlur:ae}=ta(v,{beforeFocus(){return o.readonly||f.value},afterFocus(){s.value=!0},beforeBlur(e){var a;return!q&&((a=j.value)==null?void 0:a.isFocusInsideContent(e))},afterBlur(){J(),s.value=!1,q=!1,o.validateEvent&&(R==null||R.validate("blur").catch(e=>me()))}}),Ce=u(()=>[h.b("editor"),h.bm("editor",o.type),V.e("wrapper"),h.is("disabled",f.value),h.is("active",s.value),k.b("editor"),_?k.bm("editor",_.value):"",Ie.class]),Ve=u(()=>[V.e("icon"),k.e("close-icon"),I.value?"":k.e("close-icon--hidden")]);pa(s,e=>{e?Q(()=>{e&&(Z.value=o.modelValue)}):(n.value=null,Q(()=>{H(o.modelValue)}))});const H=(e,a)=>{(a||!de(e,Z.value))&&(m("change",e),o.validateEvent&&(R==null||R.validate("change").catch(t=>me())))},y=e=>{if(!de(o.modelValue,e)){let a;w(e)?a=e.map(t=>fe(t,o.valueFormat,C.value)):e&&(a=fe(e,o.valueFormat,C.value)),m("update:modelValue",e&&a,C.value)}},Ee=e=>{m("keydown",e)},Fe=u(()=>v.value?Array.from(v.value.$el.querySelectorAll("input")):[]),Se=(e,a,t)=>{const i=Fe.value;i.length&&(!t||t==="min"?(i[0].setSelectionRange(e,a),i[0].focus()):t==="max"&&(i[1].setSelectionRange(e,a),i[1].focus()))},le=(e="",a=!1)=>{s.value=a;let t;w(e)?t=e.map(i=>i.toDate()):t=e&&e.toDate(),n.value=null,y(t)},De=()=>{L.value=!0},Re=()=>{m("visible-change",!0)},oe=()=>{L.value=!1,s.value=!1,m("visible-change",!1)},Te=()=>{s.value=!0},Me=()=>{s.value=!1},f=u(()=>o.disabled||(X==null?void 0:X.disabled)),M=u(()=>{let e;if(E.value?r.value.getDefaultValue&&(e=r.value.getDefaultValue()):w(o.modelValue)?e=o.modelValue.map(a=>ve(a,o.valueFormat,C.value)):e=ve(o.modelValue,o.valueFormat,C.value),r.value.getRangeAvailableTime){const a=r.value.getRangeAvailableTime(e);ua(a,e)||(e=a,E.value||y(A(e)))}return w(e)&&e.some(a=>!a)&&(e=[]),e}),P=u(()=>{if(!r.value.panelReady)return"";const e=Y(M.value);return w(n.value)?[n.value[0]||e&&e[0]||"",n.value[1]||e&&e[1]||""]:n.value!==null?n.value:!Oe.value&&E.value||!s.value&&E.value?"":e?ne.value||te.value||se.value?e.join(", "):e:""}),Be=u(()=>o.type.includes("time")),Oe=u(()=>o.type.startsWith("time")),ne=u(()=>o.type==="dates"),te=u(()=>o.type==="months"),se=u(()=>o.type==="years"),B=u(()=>o.prefixIcon||(Be.value?Xe:Ze)),I=g(!1),re=e=>{o.readonly||f.value||(I.value&&(e.stopPropagation(),r.value.handleClear?r.value.handleClear():y(T.value),H(T.value,!0),I.value=!1,oe()),m("clear"))},E=u(()=>{const{modelValue:e}=o;return!e||w(e)&&!e.filter(Boolean).length}),O=async e=>{var a;o.readonly||f.value||(((a=e.target)==null?void 0:a.tagName)!=="INPUT"||x.value)&&(s.value=!0)},ue=()=>{o.readonly||f.value||!E.value&&o.clearable&&(I.value=!0)},ie=()=>{I.value=!1},W=e=>{var a;o.readonly||f.value||(((a=e.touches[0].target)==null?void 0:a.tagName)!=="INPUT"||x.value)&&(s.value=!0)},Ne=u(()=>o.type.includes("range")),_=ra(),$e=u(()=>{var e,a;return(a=(e=l(j))==null?void 0:e.popperRef)==null?void 0:a.contentRef}),ce=Je(v,e=>{const a=l($e),t=Ye(v);a&&(e.target===a||e.composedPath().includes(a))||e.target===t||t&&e.composedPath().includes(t)||(s.value=!1)});da(()=>{ce==null||ce()});const n=g(null),J=()=>{if(n.value){const e=N(P.value);e&&$(e)&&(y(A(e)),n.value=null)}n.value===""&&(y(T.value),H(T.value),n.value=null)},N=e=>e?r.value.parseUserInput(e):null,Y=e=>e?r.value.formatToString(e):null,$=e=>r.value.isValidValue(e),pe=async e=>{if(o.readonly||f.value)return;const{code:a}=e;if(Ee(e),a===D.esc){s.value===!0&&(s.value=!1,e.preventDefault(),e.stopPropagation());return}if(a===D.down&&(r.value.handleFocusPicker&&(e.preventDefault(),e.stopPropagation()),s.value===!1&&(s.value=!0,await Q()),r.value.handleFocusPicker)){r.value.handleFocusPicker();return}if(a===D.tab){q=!0;return}if(a===D.enter||a===D.numpadEnter){(n.value===null||n.value===""||$(N(P.value)))&&(J(),s.value=!1),e.stopPropagation();return}if(n.value){e.stopPropagation();return}r.value.handleKeydownInput&&r.value.handleKeydownInput(e)},Ke=e=>{n.value=e,s.value||(s.value=!0)},Ae=e=>{const a=e.target;n.value?n.value=[a.value,n.value[1]]:n.value=[a.value,null]},ze=e=>{const a=e.target;n.value?n.value=[n.value[0],a.value]:n.value=[null,a.value]},Ue=()=>{var e;const a=n.value,t=N(a&&a[0]),i=l(M);if(t&&t.isValid()){n.value=[Y(t),((e=P.value)==null?void 0:e[1])||null];const F=[t,i&&(i[1]||null)];$(F)&&(y(A(F)),n.value=null)}},je=()=>{var e;const a=l(n),t=N(a&&a[1]),i=l(M);if(t&&t.isValid()){n.value=[((e=l(P))==null?void 0:e[0])||null,Y(t)];const F=[i&&i[0],t];$(F)&&(y(A(F)),n.value=null)}},r=g({}),Le=e=>{r.value[e[0]]=e[1],r.value.panelReady=!0},qe=e=>{m("calendar-change",e)},He=(e,a,t)=>{m("panel-change",e,a,t)},We=()=>{var e;(e=v.value)==null||e.focus()},_e=()=>{var e;(e=v.value)==null||e.blur()};return ma("EP_PICKER_BASE",{props:o}),Pe({focus:We,blur:_e,handleOpen:Te,handleClose:Me,onPick:le}),(e,a)=>(p(),c(l(Qe),fa({ref_key:"refPopper",ref:j,visible:s.value,effect:"light",pure:"",trigger:"click"},e.$attrs,{role:"dialog",teleported:"",transition:`${l(h).namespace.value}-zoom-in-top`,"popper-class":[`${l(h).namespace.value}-picker__popper`,e.popperClass],"popper-options":l(we),"fallback-placements":e.fallbackPlacements,"gpu-acceleration":!1,placement:e.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:De,onShow:Re,onHide:oe}),{default:d(()=>[l(Ne)?(p(),c(ea,{key:1,id:e.id,ref_key:"inputRef",ref:v,"model-value":l(P),name:e.name,disabled:l(f),readonly:!e.editable||e.readonly,"start-placeholder":e.startPlaceholder,"end-placeholder":e.endPlaceholder,class:b(l(Ce)),style:he(e.$attrs.style),"aria-label":e.ariaLabel,tabindex:e.tabindex,autocomplete:"off",role:"combobox",onClick:O,onFocus:l(ee),onBlur:l(ae),onStartInput:Ae,onStartChange:Ue,onEndInput:ze,onEndChange:je,onMousedown:O,onMouseenter:ue,onMouseleave:ie,onTouchstartPassive:W,onKeydown:pe},{prefix:d(()=>[l(B)?(p(),c(l(K),{key:0,class:b([l(V).e("icon"),l(k).e("icon")])},{default:d(()=>[(p(),c(U(l(B))))]),_:1},8,["class"])):z("v-if",!0)]),"range-separator":d(()=>[ye(e.$slots,"range-separator",{},()=>[va("span",{class:b(l(k).b("separator"))},sa(e.rangeSeparator),3)])]),suffix:d(()=>[e.clearIcon?(p(),c(l(K),{key:0,class:b(l(Ve)),onMousedown:S(l(ge),["prevent"]),onClick:re},{default:d(()=>[(p(),c(U(e.clearIcon)))]),_:1},8,["class","onMousedown"])):z("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(p(),c(l(Ge),{key:0,id:e.id,ref_key:"inputRef",ref:v,"container-role":"combobox","model-value":l(P),name:e.name,size:l(_),disabled:l(f),placeholder:e.placeholder,class:b([l(h).b("editor"),l(h).bm("editor",e.type),e.$attrs.class]),style:he(e.$attrs.style),readonly:!e.editable||e.readonly||l(ne)||l(te)||l(se)||e.type==="week","aria-label":e.ariaLabel,tabindex:e.tabindex,"validate-event":!1,onInput:Ke,onFocus:l(ee),onBlur:l(ae),onKeydown:pe,onChange:J,onMousedown:O,onMouseenter:ue,onMouseleave:ie,onTouchstartPassive:W,onClick:S(()=>{},["stop"])},{prefix:d(()=>[l(B)?(p(),c(l(K),{key:0,class:b(l(V).e("icon")),onMousedown:S(O,["prevent"]),onTouchstartPassive:W},{default:d(()=>[(p(),c(U(l(B))))]),_:1},8,["class","onMousedown"])):z("v-if",!0)]),suffix:d(()=>[I.value&&e.clearIcon?(p(),c(l(K),{key:0,class:b(`${l(V).e("icon")} clear-icon`),onMousedown:S(l(ge),["prevent"]),onClick:re},{default:d(()=>[(p(),c(U(e.clearIcon)))]),_:1},8,["class","onMousedown"])):z("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:d(()=>[ye(e.$slots,"default",{visible:s.value,actualVisible:L.value,parsedValue:l(M),format:e.format,dateFormat:e.dateFormat,timeFormat:e.timeFormat,unlinkPanels:e.unlinkPanels,type:e.type,defaultValue:e.defaultValue,showNow:e.showNow,onPick:le,onSelectRange:Se,onSetPickerOption:Le,onCalendarChange:qe,onPanelChange:He,onMousedown:S(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var Ua=aa(ga,[["__file","picker.vue"]]);export{Ua as C};
