import{a as D}from"./vendor-5WKb-KWd2YoVw.js";import{a as I,b as K}from"./vendor-nnWS-DjQn5NeA.js";import{a as P}from"./vendor-D4pM-39rNQdKa.js";import{_ as W}from"./vendor-pM4a-CqGSI99y.js";import{g as f}from"./vendor-TFZ4-Dclvbu6-.js";import{t as q}from"./vendor-9Tmw-BShLJgt0.js";import{g as F,a as G}from"./vendor-UUu6-BeUS1t8s.js";import{b as T,c as J,d as w}from"./vendor-HWBx-H0iAIG7V.js";import{a as A}from"./vendor-aqi2-CgBKjudC.js";import{u as Q}from"./vendor-unoq-CFxLHdLI.js";import{d as H,c as B,e as X,w as Y,p as Z,a as b,o as x,C as ee,b as te,r as oe}from"./vendor-RE7Z-DOm9JKld.js";import{r as u,u as m}from"./vendor-eqDO-Ti6p_k8X.js";import{a as ne,n as _}from"./vendor-7avT-DhdrFwTb.js";const re=H({name:"ElAnchor"}),se=H({...re,props:K,emits:I,setup(L,{expose:$,emit:y}){const r=L,l=u(""),p=u(null),d=u(null),s=u(),i={};let h=!1,C=0;const a=Q("anchor"),z=B(()=>[a.b(),r.type==="underline"?a.m("underline"):"",a.m(r.direction)]),N=e=>{i[e.href]=e.el},M=e=>{delete i[e]},R=e=>{l.value!==e&&(l.value=e,y("change",e))};let v=null;const O=e=>{if(!s.value)return;const t=f(e);if(!t)return;v&&v(),h=!0;const o=T(t,s.value),n=A(t,o),c=o.scrollHeight-o.clientHeight,k=Math.min(n-r.offset,c);v=J(s.value,C,k,r.duration,()=>{setTimeout(()=>{h=!1},20)})},g=e=>{e&&(R(e),O(e))},U=(e,t)=>{y("click",e,t),g(t)},E=q(()=>{s.value&&(C=w(s.value));const e=V();h||G(e)||R(e)}),V=()=>{if(!s.value)return;const e=w(s.value),t=[];for(const o of Object.keys(i)){const n=f(o);if(!n)continue;const c=T(n,s.value),k=A(n,c);t.push({top:k-r.offset-r.bound,href:o})}t.sort((o,n)=>o.top-n.top);for(let o=0;o<t.length;o++){const n=t[o],c=t[o+1];if(o===0&&e===0)return r.selectScrollTop?n.href:"";if(n.top<=e&&(!c||c.top>e))return n.href}},S=()=>{const e=f(r.container);!e||F(e)?s.value=window:s.value=e};D(s,"scroll",E);const j=B(()=>{if(!p.value||!d.value||!l.value)return{};const e=i[l.value];if(!e)return{};const t=p.value.getBoundingClientRect(),o=d.value.getBoundingClientRect(),n=e.getBoundingClientRect();return r.direction==="horizontal"?{left:`${n.left-t.left}px`,width:`${n.width}px`,opacity:1}:{top:`${n.top-t.top+(n.height-o.height)/2}px`,opacity:1}});return X(()=>{S();const e=decodeURIComponent(window.location.hash);f(e)?g(e):E()}),Y(()=>r.container,()=>{S()}),Z(P,{ns:a,direction:r.direction,currentAnchor:l,addLink:N,removeLink:M,handleClick:U}),$({scrollTo:g}),(e,t)=>(x(),b("div",{ref_key:"anchorRef",ref:p,class:_(m(z))},[e.marker?(x(),b("div",{key:0,ref_key:"markerRef",ref:d,class:_(m(a).e("marker")),style:ne(m(j))},null,6)):ee("v-if",!0),te("div",{class:_(m(a).e("list"))},[oe(e.$slots,"default")],2)],2))}});var _e=W(se,[["__file","anchor.vue"]]);export{_e as A};
