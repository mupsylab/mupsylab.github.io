import{b as L}from"./vendor-5WKb-KWd2YoVw.js";import{g as c}from"./vendor-d824-CdLXEnkb.js";import{t as U,d as w}from"./vendor-0rdd-Cq9Fpw4b.js";import{i as O}from"./vendor-16Vo-CHIgUVhi.js";import{w as d}from"./vendor-RE7Z-DOm9JKld.js";const v="ElUpload",f=u=>{var n;(n=u.url)!=null&&n.startsWith("blob:")&&URL.revokeObjectURL(u.url)},_=(u,n)=>{const r=L(u,"fileList",void 0,{passive:!0}),s=e=>r.value.find(t=>t.uid===e.uid);function i(e){var t;(t=n.value)==null||t.abort(e)}function m(e=["ready","uploading","success","fail"]){r.value=r.value.filter(t=>!e.includes(t.status))}function l(e){r.value=r.value.filter(t=>t.uid!==e.uid)}const b=(e,t)=>{const a=s(t);a&&(console.error(e),a.status="fail",l(a),u.onError(e,a,r.value),u.onChange(a,r.value))},h=(e,t)=>{const a=s(t);a&&(u.onProgress(e,a,r.value),a.status="uploading",a.percentage=Math.round(e.percent))},g=(e,t)=>{const a=s(t);a&&(a.status="success",a.response=e,u.onSuccess(e,a,r.value),u.onChange(a,r.value))},R=e=>{O(e.uid)&&(e.uid=c());const t={name:e.name,percentage:0,status:"ready",size:e.size,raw:e,uid:e.uid};if(u.listType==="picture-card"||u.listType==="picture")try{t.url=URL.createObjectURL(e)}catch(a){w(v,a.message),u.onError(a,t,r.value)}r.value=[...r.value,t],u.onChange(t,r.value)},y=async e=>{const t=e instanceof File?s(e):e;t||U(v,"file to be removed not found");const a=o=>{i(o),l(o),u.onRemove(o,r.value),f(o)};u.beforeRemove?await u.beforeRemove(t,r.value)!==!1&&a(t):a(t)};function F(){r.value.filter(({status:e})=>e==="ready").forEach(({raw:e})=>{var t;return e&&((t=n.value)==null?void 0:t.upload(e))})}return d(()=>u.listType,e=>{e!=="picture-card"&&e!=="picture"||(r.value=r.value.map(t=>{const{raw:a,url:o}=t;if(!o&&a)try{t.url=URL.createObjectURL(a)}catch(E){u.onError(E,t,r.value)}return t}))}),d(r,e=>{for(const t of e)t.uid||(t.uid=c()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:r,abort:i,clearFiles:m,handleError:b,handleProgress:h,handleStart:R,handleSuccess:g,handleRemove:y,submit:F,revokeFileObjectURL:f}};export{_ as u};
