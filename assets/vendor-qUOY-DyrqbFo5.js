import{u as C}from"./vendor-qiuV-D_CyeDDh.js";import{u as g}from"./vendor-unoq-CFxLHdLI.js";import{i as S}from"./vendor-X8wK-D6OXYL3N.js";import{t as m,g as y}from"./vendor-RE7Z-DOm9JKld.js";import{u as c}from"./vendor-eqDO-Ti6p_k8X.js";function f(e,s){return e.map(u=>{var d;return u.id===s.id?s:((d=u.children)!=null&&d.length&&(u.children=f(u.children,s)),u)})}function p(e){e.forEach(s=>{var u,d;s.no=(u=s.getColumnIndex)==null?void 0:u.call(s),(d=s.children)!=null&&d.length&&p(s.children)}),e.sort((s,u)=>s.no-u.no)}function A(){const e=y(),s=C();return{ns:g("table"),...s,mutations:{setData(o,t){const r=c(o._data)!==t;o.data.value=t,o._data.value=t,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),c(o.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):r?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(o,t,r,i){const n=c(o._columns);let l=[];r?(r&&!r.children&&(r.children=[]),r.children.push(t),l=f(n,r)):(n.push(t),l=n),p(l),o._columns.value=l,o.updateOrderFns.push(i),t.type==="selection"&&(o.selectable.value=t.selectable,o.reserveSelection.value=t.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(o,t){var r;((r=t.getColumnIndex)==null?void 0:r.call(t))!==t.no&&(p(o._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(o,t,r,i){const n=c(o._columns)||[];if(r)r.children.splice(r.children.findIndex(a=>a.id===t.id),1),m(()=>{var a;((a=r.children)==null?void 0:a.length)===0&&delete r.children}),o._columns.value=f(n,r);else{const a=n.indexOf(t);a>-1&&(n.splice(a,1),o._columns.value=n)}const l=o.updateOrderFns.indexOf(i);l>-1&&o.updateOrderFns.splice(l,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(o,t){const{prop:r,order:i,init:n}=t;if(r){const l=c(o.columns).find(a=>a.property===r);l&&(l.order=i,e.store.updateSort(l,r,i),e.store.commit("changeSortCondition",{init:n}))}},changeSortCondition(o,t){const{sortingColumn:r,sortProp:i,sortOrder:n}=o,l=c(r),a=c(i),h=c(n);S(h)&&(o.sortingColumn.value=null,o.sortProp.value=null);const v={filter:!0};e.store.execQuery(v),(!t||!(t.silent||t.init))&&e.emit("sort-change",{column:l,prop:a,order:h}),e.store.updateTableScrollY()},filterChange(o,t){const{column:r,values:i,silent:n}=t,l=e.store.updateFilters(r,i);e.store.execQuery(),n||e.emit("filter-change",l),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(o,t){e.store.toggleRowSelection(t),e.store.updateAllSelected()},setHoverRow(o,t){o.hoverRow.value=t},setCurrentRow(o,t){e.store.updateCurrentRow(t)}},commit:function(o,...t){const r=e.store.mutations;if(r[o])r[o].apply(e,[e.store.states].concat(t));else throw new Error(`Action not found: ${o}`)},updateTableScrollY:function(){m(()=>e.layout.updateScrollY.apply(e.layout))}}}export{A as u};
