import{e as p,f as F}from"./vendor-jkgG-C3m71WyD.js";import{b as l}from"./vendor-UUu6-BeUS1t8s.js";import{i as b}from"./vendor-NXsq-DDPfcrtu.js";import{e as w,j as T}from"./vendor-RE7Z-DOm9JKld.js";import{r as a}from"./vendor-eqDO-Ti6p_k8X.js";const i=a(),u=a(0),d=a(0);let r=0;const y=e=>{const o=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const n=t.tagName==="INPUT"&&t.type==="hidden";return t.disabled||t.hidden||n?NodeFilter.FILTER_SKIP:t.tabIndex>=0||t===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)o.push(s.currentNode);return o},m=(e,o)=>{for(const s of e)if(!S(s,o))return s},S=(e,o)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(o&&e===o)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},U=e=>{const o=y(e),s=m(o,e),t=m(o.reverse(),e);return[s,t]},L=e=>e instanceof HTMLInputElement&&"select"in e,N=(e,o)=>{if(e&&e.focus){const s=document.activeElement;let t=!1;l(e)&&!b(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),t=!0),e.focus({preventScroll:!0}),d.value=window.performance.now(),e!==s&&L(e)&&o&&e.select(),l(e)&&t&&e.removeAttribute("tabindex")}};function v(e,o){const s=[...e],t=e.indexOf(o);return t!==-1&&s.splice(t,1),s}const h=()=>{let e=[];return{push:t=>{const n=e[0];n&&t!==n&&n.pause(),e=v(e,t),e.unshift(t)},remove:t=>{var n,f;e=v(e,t),(f=(n=e[0])==null?void 0:n.resume)==null||f.call(n)}}},_=(e,o=!1)=>{const s=document.activeElement;for(const t of e)if(N(t,o),document.activeElement!==s)return},g=h(),x=()=>u.value>d.value,c=()=>{i.value="pointer",u.value=window.performance.now()},E=()=>{i.value="keyboard",u.value=window.performance.now()},O=()=>(w(()=>{r===0&&(document.addEventListener("mousedown",c),document.addEventListener("touchstart",c),document.addEventListener("keydown",E)),r++}),T(()=>{r--,r<=0&&(document.removeEventListener("mousedown",c),document.removeEventListener("touchstart",c),document.removeEventListener("keydown",E))}),{focusReason:i,lastUserFocusTimestamp:u,lastAutomatedFocusTimestamp:d}),A=e=>new CustomEvent(p,{...F,detail:e});export{_ as a,A as c,g as f,U as g,x as i,y as o,N as t,O as u};
