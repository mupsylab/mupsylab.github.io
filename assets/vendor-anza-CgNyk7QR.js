import{u as E}from"./vendor-5WKb-KWd2YoVw.js";import{u as dt}from"./vendor-cebD-BGFhTQCu.js";import{u as ft}from"./vendor-9Byw-aJtbE-z4.js";import{u as ve}from"./vendor-unoq-CFxLHdLI.js";import{u as vt}from"./vendor-5iTR-BBy9iiW8.js";import{u as mt}from"./vendor-GuIu-Dc0c8fP9.js";import{u as ht,a as gt}from"./vendor-eqCW-DCj8_tuZ.js";import{a as bt}from"./vendor-wml0-D8cMrmnG.js";import{i as z,d as N,f as Vt,j as me}from"./vendor-7avT-DhdrFwTb.js";import{V as xt}from"./vendor-9yxy-Cbwm2u4R.js";import{u as It}from"./vendor-hmuK-B6xHqdWm.js";import{a as A,i as Ot}from"./vendor-UUu6-BeUS1t8s.js";import{d as pt}from"./vendor-0rdd-Cq9Fpw4b.js";import{E as Ct}from"./vendor-bP7i-BUADUvnR.js";import{U as w,C as Et}from"./vendor-lLeK-BB_Ol6Sd.js";import{s as wt}from"./vendor-HWBx-H0iAIG7V.js";import{c as y}from"./vendor-sJES-T5Eo13Ui.js";import{a as he,i as yt}from"./vendor-k87t-DYFOtHqs.js";import{i as k}from"./vendor-ys5x-C1IsWqtu.js";import{g as B}from"./vendor-sXNC-Da9ghdLI.js";import{d as _t}from"./vendor-9Eji-ZqQOO7NL.js";import{f as Tt}from"./vendor-M72u-CqA7X5PQ.js";import{a as St,r as c}from"./vendor-eqDO-Ti6p_k8X.js";import{c as i,w as H,m as Rt,t as v,e as Dt}from"./vendor-RE7Z-DOm9JKld.js";const ll=(t,d)=>{const{t:_}=dt(),ge=ft(),P=ve("select"),be=ve("input"),n=St({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),Ve=c(null),g=c(null),m=c(null),K=c(null),b=c(null),xe=c(null),Ie=c(null),q=c(null),U=c(null),T=c(null),Q=c(null),{isComposing:G,handleCompositionStart:Oe,handleCompositionUpdate:pe,handleCompositionEnd:Ce}=vt({afterComposition:e=>ue(e)}),{wrapperRef:J,isFocused:X,handleBlur:Ee}=mt(b,{beforeFocus(){return I.value},afterFocus(){t.automaticDropdown&&!u.value&&(u.value=!0,n.menuVisibleOnFocus=!0)},beforeBlur(e){var l,a;return((l=m.value)==null?void 0:l.isFocusInsideContent(e))||((a=K.value)==null?void 0:a.isFocusInsideContent(e))},afterBlur(){u.value=!1,n.menuVisibleOnFocus=!1}}),u=c(!1),V=c(),{form:S,formItem:x}=ht(),{inputId:we}=gt(t,{formItemContext:x}),{valueOnClear:ye,isEmptyValue:_e}=bt(t),I=i(()=>t.disabled||(S==null?void 0:S.disabled)),$=i(()=>z(t.modelValue)?t.modelValue.length>0:!_e(t.modelValue)),Te=i(()=>{var e;return(e=S==null?void 0:S.statusIcon)!=null?e:!1}),Se=i(()=>t.clearable&&!I.value&&n.inputHovering&&$.value),Y=i(()=>t.remote&&t.filterable&&!t.remoteShowSuffix?"":t.suffixIcon),Re=i(()=>P.is("reverse",Y.value&&u.value)),Z=i(()=>(x==null?void 0:x.validateState)||""),De=i(()=>xt[Z.value]),Fe=i(()=>t.remote?300:0),Le=i(()=>t.remote&&!n.inputValue&&n.options.size===0),Me=i(()=>t.loading?t.loadingText||_("el.select.loading"):t.filterable&&n.inputValue&&n.options.size>0&&O.value===0?t.noMatchText||_("el.select.noMatch"):n.options.size===0?t.noDataText||_("el.select.noData"):null),O=i(()=>s.value.filter(e=>e.visible).length),s=i(()=>{const e=Array.from(n.options.values()),l=[];return n.optionValues.forEach(a=>{const o=e.findIndex(r=>r.value===a);o>-1&&l.push(e[o])}),l.length>=e.length?l:e}),We=i(()=>Array.from(n.cachedOptions.values())),ze=i(()=>{const e=s.value.filter(l=>!l.created).some(l=>l.currentLabel===n.inputValue);return t.filterable&&t.allowCreate&&n.inputValue!==""&&!e}),ee=()=>{t.filterable&&N(t.filterMethod)||t.filterable&&t.remote&&N(t.remoteMethod)||s.value.forEach(e=>{var l;(l=e.updateOption)==null||l.call(e,n.inputValue)})},te=It(),Ne=i(()=>["small"].includes(te.value)?"small":"default"),Ae=i({get(){return u.value&&!Le.value},set(e){u.value=e}}),Be=i(()=>{if(t.multiple&&!A(t.modelValue))return y(t.modelValue).length===0&&!n.inputValue;const e=z(t.modelValue)?t.modelValue[0]:t.modelValue;return t.filterable||A(e)?!n.inputValue:!0}),He=i(()=>{var e;const l=(e=t.placeholder)!=null?e:_("el.select.placeholder");return t.multiple||!$.value?l:n.selectedLabel}),Pe=i(()=>he?null:"mouseenter");H(()=>t.modelValue,(e,l)=>{t.multiple&&t.filterable&&!t.reserveKeyword&&(n.inputValue="",R("")),D(),!k(e,l)&&t.validateEvent&&(x==null||x.validate("change").catch(a=>pt()))},{flush:"post",deep:!0}),H(()=>u.value,e=>{e?R(n.inputValue):(n.inputValue="",n.previousQuery=null,n.isBeforeHide=!0),d("visible-change",e)}),H(()=>n.options.entries(),()=>{yt&&(D(),t.defaultFirstOption&&(t.filterable||t.remote)&&O.value&&le())},{flush:"post"}),H(()=>n.hoveringIndex,e=>{Ot(e)&&e>-1?V.value=s.value[e]||{}:V.value={},s.value.forEach(l=>{l.hover=V.value===l})}),Rt(()=>{n.isBeforeHide||ee()});const R=e=>{n.previousQuery===e||G.value||(n.previousQuery=e,t.filterable&&N(t.filterMethod)?t.filterMethod(e):t.filterable&&t.remote&&N(t.remoteMethod)&&t.remoteMethod(e),t.defaultFirstOption&&(t.filterable||t.remote)&&O.value?v(le):v(Ke))},le=()=>{const e=s.value.filter(r=>r.visible&&!r.disabled&&!r.states.groupDisabled),l=e.find(r=>r.created),a=e[0],o=s.value.map(r=>r.value);n.hoveringIndex=ce(o,l||a)},D=()=>{if(t.multiple)n.selectedLabel="";else{const l=z(t.modelValue)?t.modelValue[0]:t.modelValue,a=ne(l);n.selectedLabel=a.currentLabel,n.selected=[a];return}const e=[];A(t.modelValue)||y(t.modelValue).forEach(l=>{e.push(ne(l))}),n.selected=e},ne=e=>{let l;const a=Vt(e);for(let h=n.cachedOptions.size-1;h>=0;h--){const f=We.value[h];if(a?B(f.value,t.valueKey)===B(e,t.valueKey):f.value===e){l={value:e,currentLabel:f.currentLabel,get isDisabled(){return f.isDisabled}};break}}if(l)return l;const o=a?e.label:e??"";return{value:e,currentLabel:o}},Ke=()=>{n.hoveringIndex=s.value.findIndex(e=>n.selected.some(l=>M(l)===M(e)))},Qe=()=>{n.selectionWidth=g.value.getBoundingClientRect().width},$e=()=>{n.collapseItemWidth=T.value.getBoundingClientRect().width},j=()=>{var e,l;(l=(e=m.value)==null?void 0:e.updatePopper)==null||l.call(e)},ae=()=>{var e,l;(l=(e=K.value)==null?void 0:e.updatePopper)==null||l.call(e)},ie=()=>{n.inputValue.length>0&&!u.value&&(u.value=!0),R(n.inputValue)},ue=e=>{if(n.inputValue=e.target.value,t.remote)oe();else return ie()},oe=_t(()=>{ie()},Fe.value),p=e=>{k(t.modelValue,e)||d(Et,e)},je=e=>Tt(e,l=>{const a=n.cachedOptions.get(l);return a&&!a.disabled&&!a.states.groupDisabled}),ke=e=>{if(t.multiple&&e.code!==Ct.delete&&e.target.value.length<=0){const l=y(t.modelValue).slice(),a=je(l);if(a<0)return;const o=l[a];l.splice(a,1),d(w,l),p(l),d("remove-tag",o)}},qe=(e,l)=>{const a=n.selected.indexOf(l);if(a>-1&&!I.value){const o=y(t.modelValue).slice();o.splice(a,1),d(w,o),p(o),d("remove-tag",l.value)}e.stopPropagation(),L()},se=e=>{e.stopPropagation();const l=t.multiple?[]:ye.value;if(t.multiple)for(const a of n.selected)a.isDisabled&&l.push(a.value);d(w,l),p(l),n.hoveringIndex=-1,u.value=!1,d("clear"),L()},re=e=>{var l;if(t.multiple){const a=y((l=t.modelValue)!=null?l:[]).slice(),o=ce(a,e);o>-1?a.splice(o,1):(t.multipleLimit<=0||a.length<t.multipleLimit)&&a.push(e.value),d(w,a),p(a),e.created&&R(""),t.filterable&&!t.reserveKeyword&&(n.inputValue="")}else d(w,e.value),p(e.value),u.value=!1;L(),!u.value&&v(()=>{F(e)})},ce=(e=[],l)=>A(l)?-1:me(l.value)?e.findIndex(a=>k(B(a,t.valueKey),M(l))):e.indexOf(l.value),F=e=>{var l,a,o,r,h;const f=z(e)?e[0]:e;let W=null;if(f!=null&&f.value){const C=s.value.filter(ct=>ct.value===f.value);C.length>0&&(W=C[0].$el)}if(m.value&&W){const C=(r=(o=(a=(l=m.value)==null?void 0:l.popperRef)==null?void 0:a.contentRef)==null?void 0:o.querySelector)==null?void 0:r.call(o,`.${P.be("dropdown","wrap")}`);C&&wt(C,W)}(h=Q.value)==null||h.handleScroll()},Ue=e=>{n.options.set(e.value,e),n.cachedOptions.set(e.value,e)},Ge=(e,l)=>{n.options.get(e)===l&&n.options.delete(e)},Je=i(()=>{var e,l;return(l=(e=m.value)==null?void 0:e.popperRef)==null?void 0:l.contentRef}),Xe=()=>{n.isBeforeHide=!1,v(()=>{var e;(e=Q.value)==null||e.update(),F(n.selected)})},L=()=>{var e;(e=b.value)==null||e.focus()},Ye=()=>{var e;if(u.value){u.value=!1,v(()=>{var l;return(l=b.value)==null?void 0:l.blur()});return}(e=b.value)==null||e.blur()},Ze=e=>{se(e)},et=e=>{if(u.value=!1,X.value){const l=new FocusEvent("focus",e);v(()=>Ee(l))}},tt=()=>{n.inputValue.length>0?n.inputValue="":u.value=!1},de=()=>{I.value||(he&&(n.inputHovering=!0),n.menuVisibleOnFocus?n.menuVisibleOnFocus=!1:u.value=!u.value)},lt=()=>{if(!u.value)de();else{const e=s.value[n.hoveringIndex];e&&!e.isDisabled&&re(e)}},M=e=>me(e.value)?B(e.value,t.valueKey):e.value,nt=i(()=>s.value.filter(e=>e.visible).every(e=>e.isDisabled)),at=i(()=>t.multiple?t.collapseTags?n.selected.slice(0,t.maxCollapseTags):n.selected:[]),it=i(()=>t.multiple?t.collapseTags?n.selected.slice(t.maxCollapseTags):[]:[]),fe=e=>{if(!u.value){u.value=!0;return}if(!(n.options.size===0||O.value===0||G.value)&&!nt.value){e==="next"?(n.hoveringIndex++,n.hoveringIndex===n.options.size&&(n.hoveringIndex=0)):e==="prev"&&(n.hoveringIndex--,n.hoveringIndex<0&&(n.hoveringIndex=n.options.size-1));const l=s.value[n.hoveringIndex];(l.isDisabled||!l.visible)&&fe(e),v(()=>F(V.value))}},ut=()=>{if(!g.value)return 0;const e=window.getComputedStyle(g.value);return Number.parseFloat(e.gap||"6px")},ot=i(()=>{const e=ut();return{maxWidth:`${T.value&&t.maxCollapseTags===1?n.selectionWidth-n.collapseItemWidth-e:n.selectionWidth}px`}}),st=i(()=>({maxWidth:`${n.selectionWidth}px`})),rt=e=>{d("popup-scroll",e)};return E(g,Qe),E(q,j),E(J,j),E(U,ae),E(T,$e),Dt(()=>{D()}),{inputId:we,contentId:ge,nsSelect:P,nsInput:be,states:n,isFocused:X,expanded:u,optionsArray:s,hoverOption:V,selectSize:te,filteredOptionsCount:O,updateTooltip:j,updateTagTooltip:ae,debouncedOnInputChange:oe,onInput:ue,deletePrevTag:ke,deleteTag:qe,deleteSelected:se,handleOptionSelect:re,scrollToOption:F,hasModelValue:$,shouldShowPlaceholder:Be,currentPlaceholder:He,mouseEnterEventName:Pe,needStatusIcon:Te,showClose:Se,iconComponent:Y,iconReverse:Re,validateState:Z,validateIcon:De,showNewOption:ze,updateOptions:ee,collapseTagSize:Ne,setSelected:D,selectDisabled:I,emptyText:Me,handleCompositionStart:Oe,handleCompositionUpdate:pe,handleCompositionEnd:Ce,onOptionCreate:Ue,onOptionDestroy:Ge,handleMenuEnter:Xe,focus:L,blur:Ye,handleClearClick:Ze,handleClickOutside:et,handleEsc:tt,toggleMenu:de,selectOption:lt,getValueKey:M,navigateOptions:fe,dropdownMenuVisible:Ae,showTagList:at,collapseTagList:it,popupScroll:rt,tagStyle:ot,collapseTagStyle:st,popperRef:Je,inputRef:b,tooltipRef:m,tagTooltipRef:K,prefixRef:xe,suffixRef:Ie,selectRef:Ve,wrapperRef:J,selectionRef:g,scrollbarRef:Q,menuRef:q,tagMenuRef:U,collapseItemRef:T}};export{ll as u};
