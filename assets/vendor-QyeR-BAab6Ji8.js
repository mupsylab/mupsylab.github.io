import{E as ee}from"./vendor-iGKQ-DTfovfTi.js";import{S as A}from"./vendor-TyYs-CzlV1XM1.js";import{N as ae}from"./vendor-tTUS-BHG5Go8R.js";import{C as oe,u as ne}from"./vendor-kh7I-CWPqo4Ll.js";import{s as te,c as le,g as F}from"./vendor-xnKT-CeiNMy75.js";import{C as se}from"./vendor-kQkP-BGgZbfHt.js";import{_ as re}from"./vendor-pM4a-CqGSI99y.js";import{u as P,c as z}from"./vendor-8z51-DLeBPiYL.js";import{s as ce}from"./vendor-HWBx-H0iAIG7V.js";import{f as $,g as ue}from"./vendor-NXsq-DDPfcrtu.js";import{U as K,C as I}from"./vendor-lLeK-BB_Ol6Sd.js";import{u as de}from"./vendor-unoq-CFxLHdLI.js";import{f as U}from"./vendor-UUu6-BeUS1t8s.js";import{E as h}from"./vendor-bP7i-BUADUvnR.js";import{i as H}from"./vendor-ys5x-C1IsWqtu.js";import{f as ie}from"./vendor-Vjqg-TBkI2ktk.js";import{c as fe}from"./vendor-wm62-DP3OYY5P.js";import{d as me,v as pe,a as G,o as D,F as ve,D as he,f as Ne,h as ge,r as Ee,c as J,p as Ce,w as V,X as ye,e as ke,t as _e}from"./vendor-RE7Z-DOm9JKld.js";import{n as be}from"./vendor-7avT-DhdrFwTb.js";import{r as k,a as R}from"./vendor-eqDO-Ti6p_k8X.js";import{i as we}from"./vendor-k87t-DYFOtHqs.js";const Se=me({name:"ElCascaderPanel",components:{ElCascaderMenu:ee},props:{...oe,border:{type:Boolean,default:!0},renderLabel:Function},emits:[K,I,"close","expand-change"],setup(s,{emit:N,slots:L}){let _=!1;const d=de("cascader"),u=ne(s);let r=null;const g=k(!0),i=k([]),E=k(null),v=k([]),C=k(null),p=k([]),X=J(()=>u.value.expandTrigger==="hover"),Y=J(()=>s.renderLabel||L.default),j=()=>{const{options:e}=s,a=u.value;_=!1,r=new A(e,a),v.value=[r.getNodes()],a.lazy&&U(s.options)?(g.value=!1,w(void 0,o=>{o&&(r=new A(o,a),v.value=[r.getNodes()]),g.value=!0,y(!1,!0)})):y(!1,!0)},w=(e,a)=>{const o=u.value;e=e||new ae({},o,void 0,!0),e.loading=!0;const n=t=>{const l=e,f=l.root?null:l;t&&(r==null||r.appendNodes(t,f)),l.loading=!1,l.loaded=!0,l.childrenData=l.childrenData||[],a&&a(t)};o.lazyLoad(e,n)},S=(e,a)=>{var o;const{level:n}=e,t=v.value.slice(0,n);let l;e.isLeaf?l=e.pathNodes[n-2]:(l=e,t.push(e.children)),((o=C.value)==null?void 0:o.uid)!==(l==null?void 0:l.uid)&&(C.value=e,v.value=t,!a&&N("expand-change",(e==null?void 0:e.pathValues)||[]))},B=(e,a,o=!0)=>{const{checkStrictly:n,multiple:t}=u.value,l=p.value[0];_=!0,!t&&(l==null||l.doCheck(!1)),e.doCheck(a),x(),o&&!t&&!n&&N("close"),!o&&!t&&!n&&M(e)},M=e=>{e&&(e=e.parent,M(e),e&&S(e))},T=e=>r==null?void 0:r.getFlattedNodes(e),q=e=>{var a;return(a=T(e))==null?void 0:a.filter(o=>o.checked!==!1)},Q=()=>{p.value.forEach(e=>e.doCheck(!1)),x(),v.value=v.value.slice(0,1),C.value=null,N("expand-change",[])},x=()=>{var e;const{checkStrictly:a,multiple:o}=u.value,n=p.value,t=q(!a),l=te(n,t),f=l.map(c=>c.valueByOption);p.value=l,E.value=o?f:(e=f[0])!=null?e:null},y=(e=!1,a=!1)=>{const{modelValue:o}=s,{lazy:n,multiple:t,checkStrictly:l}=u.value,f=!l;if(!(!g.value||_||!a&&H(o,E.value)))if(n&&!e){const b=P(ie(z(o))).map(m=>r==null?void 0:r.getNodeByValue(m)).filter(m=>!!m&&!m.loaded&&!m.loading);b.length?b.forEach(m=>{w(m,()=>y(!1,a))}):y(!0,a)}else{const c=t?z(o):[o],b=P(c.map(m=>r==null?void 0:r.getNodeByValue(m,f)));W(b,a),E.value=fe(o)}},W=(e,a=!0)=>{const{checkStrictly:o}=u.value,n=p.value,t=e.filter(c=>!!c&&(o||c.isLeaf)),l=r==null?void 0:r.getSameNode(C.value),f=a&&l||t[0];f?f.pathNodes.forEach(c=>S(c,!0)):C.value=null,n.forEach(c=>c.doCheck(!1)),R(t).forEach(c=>c.doCheck(!0)),p.value=t,_e(O)},O=()=>{we&&i.value.forEach(e=>{const a=e==null?void 0:e.$el;if(a){const o=a.querySelector(`.${d.namespace.value}-scrollbar__wrap`),n=a.querySelector(`.${d.b("node")}.${d.is("active")}`)||a.querySelector(`.${d.b("node")}.in-active-path`);ce(o,n)}})},Z=e=>{const a=e.target,{code:o}=e;switch(o){case h.up:case h.down:{e.preventDefault();const n=o===h.up?-1:1;$(ue(a,n,`.${d.b("node")}[tabindex="-1"]`));break}case h.left:{e.preventDefault();const n=i.value[F(a)-1],t=n==null?void 0:n.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);$(t);break}case h.right:{e.preventDefault();const n=i.value[F(a)+1],t=n==null?void 0:n.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);$(t);break}case h.enter:case h.numpadEnter:le(a);break}};return Ce(se,R({config:u,expandingNode:C,checkedNodes:p,isHoverMenu:X,initialLoaded:g,renderLabelFn:Y,lazyLoad:w,expandNode:S,handleCheckChange:B})),V([u,()=>s.options],j,{deep:!0,immediate:!0}),V(()=>s.modelValue,()=>{_=!1,y()},{deep:!0}),V(()=>E.value,e=>{H(e,s.modelValue)||(N(K,e),N(I,e))}),ye(()=>i.value=[]),ke(()=>!U(s.modelValue)&&y()),{ns:d,menuList:i,menus:v,checkedNodes:p,handleKeyDown:Z,handleCheckChange:B,getFlattedNodes:T,getCheckedNodes:q,clearCheckedNodes:Q,calculateCheckedValue:x,scrollToExpandingNode:O}}});function xe(s,N,L,_,d,u){const r=pe("el-cascader-menu");return D(),G("div",{class:be([s.ns.b("panel"),s.ns.is("bordered",s.border)]),onKeydown:s.handleKeyDown},[(D(!0),G(ve,null,he(s.menus,(g,i)=>(D(),Ne(r,{key:i,ref_for:!0,ref:E=>s.menuList[i]=E,index:i,nodes:[...g]},{empty:ge(()=>[Ee(s.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var Ye=re(Se,[["render",xe],["__file","index.vue"]]);export{Ye as C};
