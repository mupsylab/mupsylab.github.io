import{T as R}from"./vendor-ixTu-B_aMp52B.js";import{h as C,r as M,a as _}from"./vendor-7XBs-C2ZIZBcB.js";import{b as D}from"./vendor-UUu6-BeUS1t8s.js";import{i as O}from"./vendor-X8wK-D6OXYL3N.js";import{l as X,g as $}from"./vendor-RE7Z-DOm9JKld.js";import{r as b}from"./vendor-eqDO-Ti6p_k8X.js";import{i as k}from"./vendor-k87t-DYFOtHqs.js";function K(v,p){const P=$(),u=X(R),y=t=>{t.stopPropagation()},T=(t,e)=>{!e.filters&&e.sortable?E(t,e,!1):e.filterable&&!e.sortable&&y(t),u==null||u.emit("header-click",e,t)},w=(t,e)=>{u==null||u.emit("header-contextmenu",e,t)},m=b(null),h=b(!1),f=b({}),z=(t,e)=>{if(k&&!(e.children&&e.children.length>0)&&m.value&&v.border){h.value=!0;const s=u;p("set-drag-visible",!0);const r=(s==null?void 0:s.vnode.el).getBoundingClientRect().left,n=P.vnode.el.querySelector(`th.${e.id}`),l=n.getBoundingClientRect(),o=l.left-r+30;_(n,"noclick"),f.value={startMouseLeft:t.clientX,startLeft:l.right-r,startColumnLeft:l.left-r,tableLeft:r};const a=s==null?void 0:s.refs.resizeProxy;a.style.left=`${f.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const g=c=>{const L=c.clientX-f.value.startMouseLeft,x=f.value.startLeft+L;a.style.left=`${Math.max(o,x)}px`},i=()=>{if(h.value){const{startColumnLeft:c,startLeft:L}=f.value,I=Number.parseInt(a.style.left,10)-c;e.width=e.realWidth=I,s==null||s.emit("header-dragend",e.width,L-c,e,t),requestAnimationFrame(()=>{v.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",h.value=!1,m.value=null,f.value={},p("set-drag-visible",!1)}document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",i),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{M(n,"noclick")},0)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",i)}},N=(t,e)=>{var s;if(e.children&&e.children.length>0)return;const d=t.target;if(!D(d))return;const r=d==null?void 0:d.closest("th");if(!(!e||!e.resizable||!r)&&!h.value&&v.border){const n=r.getBoundingClientRect(),l=document.body.style,o=((s=r.parentNode)==null?void 0:s.lastElementChild)===r,a=v.allowDragLastColumn||!o;n.width>12&&n.right-t.pageX<8&&a?(l.cursor="col-resize",C(r,"is-sortable")&&(r.style.cursor="col-resize"),m.value=e):h.value||(l.cursor="",C(r,"is-sortable")&&(r.style.cursor="pointer"),m.value=null)}},S=()=>{k&&(document.body.style.cursor="")},B=({order:t,sortOrders:e})=>{if(t==="")return e[0];const s=e.indexOf(t||null);return e[s>e.length-2?0:s+1]},E=(t,e,s)=>{var d;t.stopPropagation();const r=e.order===s?null:s||B(e),n=(d=t.target)==null?void 0:d.closest("th");if(n&&C(n,"noclick")){M(n,"noclick");return}if(!e.sortable)return;const l=t.currentTarget;if(["ascending","descending"].some(c=>C(l,c)&&!e.sortOrders.includes(c)))return;const o=v.store.states;let a=o.sortProp.value,g;const i=o.sortingColumn.value;(i!==e||i===e&&O(i.order))&&(i&&(i.order=null),o.sortingColumn.value=e,a=e.property),r?g=e.order=r:g=e.order=null,o.sortProp.value=a,o.sortOrder.value=g,u==null||u.store.commit("changeSortCondition")};return{handleHeaderClick:T,handleHeaderContextMenu:w,handleMouseDown:z,handleMouseMove:N,handleMouseOut:S,handleSortClick:E,handleFilterClick:y}}export{K as u};
