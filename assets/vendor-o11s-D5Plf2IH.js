import{b as W}from"./vendor-8F4M-BzORa8vA.js";import{E as X}from"./vendor-AOIz-Bx1mEe3u.js";import{E as Y}from"./vendor-NFpn-BrHihosC.js";import{k as ee,b as oe}from"./vendor-Fq1d-qefZ2EtI.js";import{E as ne}from"./vendor-AQSj-DFJim-ok.js";import{u as te}from"./vendor-viMc-ByXOqDO1.js";import{u as ae}from"./vendor-N4yc-B2t-Qsd8.js";import{b as le}from"./vendor-BvSU-CYRVtLwv.js";import{i as I}from"./vendor-9yxy-Cbwm2u4R.js";import{u as B}from"./vendor-unoq-CFxLHdLI.js";import{t as $}from"./vendor-0rdd-Cq9Fpw4b.js";import{c as ue}from"./vendor-7avT-DhdrFwTb.js";import{d as se,c as t,l as A,w as re,p as ie,g as ce,e as pe,j as de,n as s,y as ve,F as me}from"./vendor-RE7Z-DOm9JKld.js";import{r as f,a as fe}from"./vendor-eqDO-Ti6p_k8X.js";import{u as R}from"./vendor-k87t-DYFOtHqs.js";const be=le({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:I},expandOpenIcon:{type:I},collapseCloseIcon:{type:I},collapseOpenIcon:{type:I}}),O="ElSubMenu";var ze=se({name:O,props:be,setup(n,{slots:p,expose:D}){const g=ce(),{indexPath:b,parentMenu:E}=te(g,t(()=>n.index)),r=B("menu"),c=B("sub-menu"),o=A("rootMenu");o||$(O,"can not inject root menu");const a=A(`subMenu:${E.value.uid}`);a||$(O,"can not inject sub menu");const H=f({}),x=f({});let d;const P=f(!1),q=f(),k=f(),z=t(()=>v.value==="horizontal"&&h.value?"bottom-start":"right-start"),T=t(()=>v.value==="horizontal"&&h.value||v.value==="vertical"&&!o.props.collapse?n.expandCloseIcon&&n.expandOpenIcon?i.value?n.expandOpenIcon:n.expandCloseIcon:ee:n.collapseCloseIcon&&n.collapseOpenIcon?i.value?n.collapseOpenIcon:n.collapseCloseIcon:oe),h=t(()=>a.level===0),S=t(()=>{const e=n.teleported;return e===void 0?h.value:e}),L=t(()=>o.props.collapse?`${r.namespace.value}-zoom-in-left`:`${r.namespace.value}-zoom-in-top`),U=t(()=>v.value==="horizontal"&&h.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),i=t(()=>o.openedMenus.includes(n.index)),_=t(()=>[...Object.values(H.value),...Object.values(x.value)].some(({active:e})=>e)),v=t(()=>o.props.mode),V=t(()=>o.props.persistent),M=fe({index:n.index,indexPath:b,active:_}),N=ae(o.props,a.level+1),Z=t(()=>{var e;return(e=n.popperOffset)!=null?e:o.props.popperOffset}),j=t(()=>{var e;return(e=n.popperClass)!=null?e:o.props.popperClass}),G=t(()=>{var e;return(e=n.showTimeout)!=null?e:o.props.showTimeout}),J=t(()=>{var e;return(e=n.hideTimeout)!=null?e:o.props.hideTimeout}),K=()=>{var e,l,u;return(u=(l=(e=k.value)==null?void 0:e.popperRef)==null?void 0:l.popperInstanceRef)==null?void 0:u.destroy()},Q=e=>{e||K()},F=()=>{o.props.menuTrigger==="hover"&&o.props.mode==="horizontal"||o.props.collapse&&o.props.mode==="vertical"||n.disabled||o.handleSubMenuClick({index:n.index,indexPath:b.value,active:_.value})},C=(e,l=G.value)=>{var u;if(e.type!=="focus"){if(o.props.menuTrigger==="click"&&o.props.mode==="horizontal"||!o.props.collapse&&o.props.mode==="vertical"||n.disabled){a.mouseInChild.value=!0;return}a.mouseInChild.value=!0,d==null||d(),{stop:d}=R(()=>{o.openMenu(n.index,b.value)},l),S.value&&((u=E.value.vnode.el)==null||u.dispatchEvent(new MouseEvent("mouseenter")))}},w=(e=!1)=>{var l;if(o.props.menuTrigger==="click"&&o.props.mode==="horizontal"||!o.props.collapse&&o.props.mode==="vertical"){a.mouseInChild.value=!1;return}d==null||d(),a.mouseInChild.value=!1,{stop:d}=R(()=>!P.value&&o.closeMenu(n.index,b.value),J.value),S.value&&e&&((l=a.handleMouseleave)==null||l.call(a,!0))};re(()=>o.props.collapse,e=>Q(!!e));{const e=u=>{x.value[u.index]=u},l=u=>{delete x.value[u.index]};ie(`subMenu:${g.uid}`,{addSubMenu:e,removeSubMenu:l,handleMouseleave:w,mouseInChild:P,level:a.level+1})}return D({opened:i}),pe(()=>{o.addSubMenu(M),a.addSubMenu(M)}),de(()=>{a.removeSubMenu(M),o.removeSubMenu(M)}),()=>{var e;const l=[(e=p.title)==null?void 0:e.call(p),s(ne,{class:c.e("icon-arrow"),style:{transform:i.value?n.expandCloseIcon&&n.expandOpenIcon||n.collapseCloseIcon&&n.collapseOpenIcon&&o.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>ue(T.value)?s(g.appContext.components[T.value]):s(T.value)})],u=o.isMenuPopup?s(Y,{ref:k,visible:i.value,effect:"light",pure:!0,offset:Z.value,showArrow:!1,persistent:V.value,popperClass:j.value,placement:z.value,teleported:S.value,fallbackPlacements:U.value,transition:L.value,gpuAcceleration:!1},{content:()=>{var m;return s("div",{class:[r.m(v.value),r.m("popup-container"),j.value],onMouseenter:y=>C(y,100),onMouseleave:()=>w(!0),onFocus:y=>C(y,100)},[s("ul",{class:[r.b(),r.m("popup"),r.m(`popup-${z.value}`)],style:N.value},[(m=p.default)==null?void 0:m.call(p)])])},default:()=>s("div",{class:c.e("title"),onClick:F},l)}):s(me,{},[s("div",{class:c.e("title"),ref:q,onClick:F},l),s(X,{},{default:()=>{var m;return ve(s("ul",{role:"menu",class:[r.b(),r.m("inline")],style:N.value},[(m=p.default)==null?void 0:m.call(p)]),[[W,i.value]])}})]);return s("li",{class:[c.b(),c.is("active",_.value),c.is("opened",i.value),c.is("disabled",n.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:i.value,onMouseenter:C,onMouseleave:()=>w(),onFocus:C},[u])}}});export{ze as S};
