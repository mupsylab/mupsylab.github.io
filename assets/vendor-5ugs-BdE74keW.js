import{d as A}from"./vendor-v13v-B_uL0f_K.js";import{b as Z}from"./vendor-4YxN-Ca0MF-br.js";import{u as E}from"./vendor-cebD-BGFhTQCu.js";import{c as N}from"./vendor-8z51-DLeBPiYL.js";import{u as p}from"./vendor-unoq-CFxLHdLI.js";import{i as ee}from"./vendor-7avT-DhdrFwTb.js";import{f as te}from"./vendor-ruXi-BZ-Dw9Cr.js";import{r as b,u as o}from"./vendor-eqDO-Ti6p_k8X.js";import{c as m,w as ae,t as se}from"./vendor-RE7Z-DOm9JKld.js";const S=(a="")=>["normal","today"].includes(a),me=(a,f)=>{const{lang:g}=E(),D=b(),k=b(),w=b(),M=b(),O=b([[],[],[],[],[],[]]);let C=!1;const y=a.date.$locale().weekStart||7,r=a.date.locale("en").localeData().weekdaysShort().map(e=>e.toLowerCase()),d=m(()=>y>3?7-y:-y),x=m(()=>{const e=a.date.startOf("month");return e.subtract(e.day()||7,"day")}),L=m(()=>r.concat(r).slice(y,y+7)),R=m(()=>te(o(v)).some(e=>e.isCurrent)),_=m(()=>{const e=a.date.startOf("month"),t=e.day()||7,s=e.daysInMonth(),n=e.subtract(1,"month").daysInMonth();return{startOfMonthDay:t,dateCountOfMonth:s,dateCountOfLastMonth:n}}),K=m(()=>a.selectionMode==="dates"?N(a.parsedValue):[]),j=(e,{count:t,rowIndex:s,columnIndex:n})=>{const{startOfMonthDay:c,dateCountOfMonth:u,dateCountOfLastMonth:l}=o(_),h=o(d);if(s>=0&&s<=1){const i=c+h<0?7+c+h:c+h;if(n+s*7>=i)return e.text=t,!0;e.text=l-(i-n%7)+1+s*7,e.type="prev-month"}else return t<=u?e.text=t:(e.text=t-u,e.type="next-month"),!0;return!1},F=(e,{columnIndex:t,rowIndex:s},n)=>{const{disabledDate:c,cellClassName:u}=a,l=o(K),h=j(e,{count:n,rowIndex:s,columnIndex:t}),i=e.dayjs.toDate();return e.selected=l.find(Y=>Y.isSame(e.dayjs,"day")),e.isSelected=!!e.selected,e.isCurrent=T(e),e.disabled=c==null?void 0:c(i),e.customClass=u==null?void 0:u(i),h},$=e=>{if(a.selectionMode==="week"){const[t,s]=a.showWeekNumber?[1,7]:[0,6],n=I(e[t+1]);e[t].inRange=n,e[t].start=n,e[s].inRange=n,e[s].end=n}},v=m(()=>{const{minDate:e,maxDate:t,rangeState:s,showWeekNumber:n}=a,c=o(d),u=o(O),l="day";let h=1;if(n)for(let i=0;i<6;i++)u[i][0]||(u[i][0]={type:"week",text:o(x).add(i*7+1,l).week()});return Z({row:6,column:7},u,{startDate:e,columnIndexOffset:n?1:0,nextEndDate:s.endDate||t||s.selecting&&e||null,now:A().locale(o(g)).startOf(l),unit:l,relativeDateGetter:i=>o(x).add(i-c,l),setCellMetadata:(...i)=>{F(...i,h)&&(h+=1)},setRowMetadata:$}),u});ae(()=>a.date,async()=>{var e;(e=o(D))!=null&&e.contains(document.activeElement)&&(await se(),await V())});const V=async()=>{var e;return(e=o(k))==null?void 0:e.focus()},T=e=>a.selectionMode==="date"&&S(e.type)&&B(e,a.parsedValue),B=(e,t)=>t?A(t).locale(o(g)).isSame(a.date.date(Number(e.text)),"day"):!1,W=(e,t)=>{const s=e*7+(t-(a.showWeekNumber?1:0))-o(d);return o(x).add(s,"day")},U=e=>{var t;if(!a.rangeState.selecting)return;let s=e.target;if(s.tagName==="SPAN"&&(s=(t=s.parentNode)==null?void 0:t.parentNode),s.tagName==="DIV"&&(s=s.parentNode),s.tagName!=="TD")return;const n=s.parentNode.rowIndex-1,c=s.cellIndex;o(v)[n][c].disabled||(n!==o(w)||c!==o(M))&&(w.value=n,M.value=c,f("changerange",{selecting:!0,endDate:W(n,c)}))},G=e=>!o(R)&&(e==null?void 0:e.text)===1&&e.type==="normal"||e.isCurrent,q=e=>{C||o(R)||a.selectionMode!=="date"||P(e,!0)},z=e=>{e.target.closest("td")&&(C=!0)},H=e=>{e.target.closest("td")&&(C=!1)},J=e=>{!a.rangeState.selecting||!a.minDate?(f("pick",{minDate:e,maxDate:null}),f("select",!0)):(e>=a.minDate?f("pick",{minDate:a.minDate,maxDate:e}):f("pick",{minDate:e,maxDate:a.minDate}),f("select",!1))},Q=e=>{const t=e.week(),s=`${e.year()}w${t}`;f("pick",{year:e.year(),week:t,value:s,date:e.startOf("week")})},X=(e,t)=>{const s=t?N(a.parsedValue).filter(n=>(n==null?void 0:n.valueOf())!==e.valueOf()):N(a.parsedValue).concat([e]);f("pick",s)},P=(e,t=!1)=>{const s=e.target.closest("td");if(!s)return;const n=s.parentNode.rowIndex-1,c=s.cellIndex,u=o(v)[n][c];if(u.disabled||u.type==="week")return;const l=W(n,c);switch(a.selectionMode){case"range":{J(l);break}case"date":{f("pick",l,t);break}case"week":{Q(l);break}case"dates":{X(l,!!u.selected);break}}},I=e=>{if(a.selectionMode!=="week")return!1;let t=a.date.startOf("day");if(e.type==="prev-month"&&(t=t.subtract(1,"month")),e.type==="next-month"&&(t=t.add(1,"month")),t=t.date(Number.parseInt(e.text,10)),a.parsedValue&&!ee(a.parsedValue)){const s=(a.parsedValue.day()-y+7)%7-1;return a.parsedValue.subtract(s,"day").isSame(t,"day")}return!1};return{WEEKS:L,rows:v,tbodyRef:D,currentCellRef:k,focus:V,isCurrent:T,isWeekActive:I,isSelectedCell:G,handlePickDate:P,handleMouseUp:H,handleMouseDown:z,handleMouseMove:U,handleFocus:q}},he=(a,{isCurrent:f,isWeekActive:g})=>{const D=p("date-table"),{t:k}=E(),w=m(()=>[D.b(),{"is-week-mode":a.selectionMode==="week"}]),M=m(()=>k("el.datepicker.dateTablePrompt")),O=m(()=>k("el.datepicker.week"));return{tableKls:w,tableLabel:M,weekLabel:O,getCellClasses:r=>{const d=[];return S(r.type)&&!r.disabled?(d.push("available"),r.type==="today"&&d.push("today")):d.push(r.type),f(r)&&d.push("current"),r.inRange&&(S(r.type)||a.selectionMode==="week")&&(d.push("in-range"),r.start&&d.push("start-date"),r.end&&d.push("end-date")),r.disabled&&d.push("disabled"),r.selected&&d.push("selected"),r.customClass&&d.push(r.customClass),d.join(" ")},getRowKls:r=>[D.e("row"),{current:g(r)}],t:k}};export{he as a,me as u};
